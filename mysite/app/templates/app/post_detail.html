{% extends 'app/base.html' %}
{%load static%}

{% block content %}

<form action="" method="post" enctype="multipart/form-data">
  {% csrf_token %}
<div class="container">    
  <article class="post">
    {% if request.user.is_authenticated %}
      <aside class="actions">
        <a class="btn btn-secondary" href="{% url 'app:post_edit' slug=post.slug %}">
         <i class="fa-solid fa-pen">Edit</i>
        </a>
    </aside>
     {% else %}
    {% endif %} 
    

      {% if posts.published_date %}
      <time class="date">
        {{ posts.published_date }}
      </time>
      {% endif %}


      <div class="dflex" style="display:flex;gap:20px">
        <img src="{{post.thumb_image.url}}" width="60" height="60" style="border-radius:70%">
        <h2 class="py-3">{{ post.title }}</h2>
      </div>
      
      
      <img src="{{post.feature_image.url}}" width="100%" height="350">
      <p class="my-4">{{ post.text | linebreaksbr }}</p>

      <p style='float:left;'>
        Category:<a href="{% url 'app:category_detail' post.category.slug %}">{{ post.category.category_name }}</a>
      
        <p>
        {% if post.tag %}
        
        {% comment %} tags:{{i.tag_name}} {% endcomment %}
        {% for i in post.tag.all %}
       
        tags: <a href="{% url 'app:tag_detail' slug=i.slug %}">{{i.tag_name}}</a>
        {% endfor %}        
        {% endif %}
        </p>
   

       
         <p>{% if user.profile_image %}<img src="{{user.profile_image.url}}" width="40" height="40" style="border-radius:70%">{% endif %}
          <a href="{% url 'app:profile' %}" class="text-decoration-none ">
            <span class='mx-3 text-danger fs-4'>{{user.name}}</span></a></h2></p> 
    
      
    </article>

  </form>

    <hr>
   
    <form method='POST'>
      {%csrf_token%}
      {% if request.user.is_authenticated %}
      {{comment_form.as_p}}
      {% comment %} {% if request.user.is_authenticated %} {% endcomment %}
      <input type="submit" value="Submit" class="btn btn-outline-success">
        {% else %}
      <!-- <input type="submit" value="Submit"class="btn btn-outline-success" disabled> -->
      {% comment %} <li><a href="/login_view/">LogIn</a></li> {% endcomment %}
        {% endif %}
    
    </form>
  


    

    <div class='main-comment-section'><strong>
      {{comments.count}} Comment {{comments|pluralize}}</strong>
      {% for comment in comments %}
      <blockquote class="blockquote">
        <p class="mb-0">{{comment.comment}}</p><br>
        <footer class="blockquote-footer">by <cite title="Source Title">{{comment.user|capfirst}}
        </cite>
       <button type="button" name="button" class="reply-btn btn btn-outline-dark  btn-sm ml"style='display:;'>Reply</button>
      </footer>
      </blockquote>

        <div class="replied-comments container mt-2" style='display:none;'>
          {% for reply in comment.replies.all %}
          <blockquote class="blockquote">
            <p class="mb-0"><small>{{reply.comment}}</small></p><br>
            <footer class="blockquote-footer"><small>by <cite title="Source Title">{{reply.user|capfirst}}
              </cite></small></footer>
          </blockquote>
          {% endfor %}
          <div class="from-group row">
            <form method="post" class="form-class">
              {% csrf_token %}
              <input type="hidden" name="comment_id" value="{{ comment.id }}">
              {{comment_form.as_p}}
              {% if request.user.is_authenticated %}
                <input type="submit" value="Submit" class="btn btn-outline-success">
              {% else %}
              {% endif %}
            </form>
          </div>
        </div>
</div>
      {% endfor %}
    </div>

  
  </div>
  
    {% endblock %}
  
  